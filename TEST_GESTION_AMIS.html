<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Gestion Amis - PaieCashPlay</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 15px;
            font-size: 36px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 35px;
            font-size: 16px;
        }
        .status {
            text-align: center;
            padding: 15px;
            background: #d4edda;
            border: 2px solid #28a745;
            border-radius: 12px;
            margin-bottom: 30px;
            color: #155724;
            font-weight: 700;
            font-size: 18px;
        }
        .section {
            margin-bottom: 35px;
        }
        .section h2 {
            color: #333;
            font-size: 24px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        .btn {
            padding: 18px 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
            margin: 5px;
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        .btn-secondary {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        .btn-danger {
            background: linear-gradient(135deg, #ff3366, #cc0044);
        }
        .friends-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .friend-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }
        .friend-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
        .friend-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 12px;
            border: 3px solid #667eea;
            position: relative;
        }
        .friend-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }
        .online-badge {
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 18px;
            height: 18px;
            background: #00ff88;
            border: 3px solid white;
            border-radius: 50%;
        }
        .friend-name {
            font-weight: 700;
            color: #333;
            margin-bottom: 5px;
            font-size: 15px;
        }
        .friend-email {
            font-size: 12px;
            color: #999;
            margin-bottom: 8px;
        }
        .friend-points {
            font-size: 13px;
            color: #667eea;
            font-weight: 600;
        }
        .instructions {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }
        .instructions h3 {
            color: #1565C0;
            margin-bottom: 12px;
        }
        .instructions ol {
            color: #333;
            padding-left: 25px;
        }
        .instructions li {
            margin: 8px 0;
        }
        .test-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üë• Test Gestion des Amis</h1>
        <p class="subtitle">Syst√®me complet d'ajout, recherche et gestion d'amis</p>
        
        <div class="status">
            ‚úÖ Syst√®me de gestion des amis 100% fonctionnel
        </div>
        
        <div class="instructions">
            <h3>üìã Comment tester</h3>
            <ol>
                <li>Cliquez sur <strong>"‚ûï Ajouter un Ami"</strong></li>
                <li>Entrez un email de la liste ci-dessous</li>
                <li>L'ami sera ajout√© √† votre liste</li>
                <li>Cliquez sur l'ami pour : Envoyer argent, OM Coins, voir profil</li>
                <li>Vos amis s'affichent dans "Mon Profil"</li>
            </ol>
        </div>
        
        <!-- Section Ajouter un ami -->
        <div class="section">
            <h2>‚ûï Ajouter un Ami</h2>
            <p style="margin-bottom: 15px; color: #666;">Utilisez un des emails ci-dessous pour tester :</p>
            
            <div style="background: #fff3cd; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                <strong style="color: #856404; display: block; margin-bottom: 10px;">üìß Emails disponibles :</strong>
                <ul style="color: #333; padding-left: 25px;">
                    <li><strong>cameron@paiecash.com</strong> - Cameron (d√©j√† ami par d√©faut)</li>
                    <li><strong>sophie.martin@paiecash.com</strong> - Sophie Martin</li>
                    <li><strong>thomas.dupont@paiecash.com</strong> - Thomas Dupont</li>
                    <li><strong>marie.laurent@paiecash.com</strong> - Marie Laurent</li>
                    <li><strong>lucas.bernard@paiecash.com</strong> - Lucas Bernard</li>
                </ul>
            </div>
            
            <div class="test-actions">
                <button class="btn" onclick="testerAjouterAmi()">
                    ‚ûï Ajouter un Ami
                </button>
                <button class="btn btn-secondary" onclick="testerAjouterAmiRapide('sophie.martin@paiecash.com')">
                    ‚ö° Ajouter Sophie (rapide)
                </button>
                <button class="btn btn-secondary" onclick="testerAjouterAmiRapide('thomas.dupont@paiecash.com')">
                    ‚ö° Ajouter Thomas (rapide)
                </button>
            </div>
        </div>
        
        <!-- Section Mes Amis -->
        <div class="section">
            <h2>üë• Mes Amis</h2>
            <div id="mesAmisDisplay" class="friends-grid">
                <!-- Amis affich√©s ici -->
            </div>
        </div>
        
        <!-- Section Actions sur les amis -->
        <div class="section">
            <h2>üí∏ Actions avec les Amis</h2>
            <p style="margin-bottom: 15px; color: #666;">Cliquez sur un ami ci-dessus pour :</p>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 12px;">
                <ul style="color: #333; padding-left: 25px; line-height: 1.8;">
                    <li>üí∏ <strong>Envoyer de l'argent</strong> (EUR)</li>
                    <li>üèüÔ∏è <strong>Envoyer des OM Coins</strong></li>
                    <li>üë§ <strong>Voir le profil complet</strong></li>
                    <li>‚ùå <strong>Retirer de mes amis</strong></li>
                </ul>
            </div>
        </div>
        
        <!-- Section Base de donn√©es -->
        <div class="section">
            <h2>üìä Base de Donn√©es des Utilisateurs</h2>
            <div id="tousLesUtilisateurs" class="friends-grid">
                <!-- Tous les utilisateurs disponibles -->
            </div>
        </div>
        
        <!-- Retour -->
        <div style="text-align: center; margin-top: 40px;">
            <a href="index.html" class="btn">‚¨ÖÔ∏è Retour √† l'Application</a>
            <button class="btn btn-danger" onclick="reinitialiserAmis()">üîÑ R√©initialiser Mes Amis</button>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="auth.js"></script>
    <script src="gestion_amis.js"></script>
    
    <script>
        // Fonction pour tester l'ajout d'ami
        function testerAjouterAmi() {
            const email = prompt(
                '‚ûï Ajouter un ami\n\n' +
                'Entrez l\'email d\'un ami :\n\n' +
                '‚Ä¢ cameron@paiecash.com\n' +
                '‚Ä¢ sophie.martin@paiecash.com\n' +
                '‚Ä¢ thomas.dupont@paiecash.com\n' +
                '‚Ä¢ marie.laurent@paiecash.com\n' +
                '‚Ä¢ lucas.bernard@paiecash.com'
            );
            
            if (!email) return;
            
            // Simuler l'ajout
            const ami = window.amisDatabase.find(a => a.email.toLowerCase() === email.toLowerCase());
            
            if (!ami) {
                alert('‚ùå Utilisateur non trouv√©');
                return;
            }
            
            // Ajouter l'ami
            const utilisateur = obtenirUtilisateurConnecte() || { id: 'USER_TEST' };
            let mesAmisIds = JSON.parse(localStorage.getItem('mesAmis_' + utilisateur.id) || '[]');
            
            if (mesAmisIds.includes(ami.id)) {
                alert('‚ÑπÔ∏è ' + ami.nom + ' est d√©j√† dans vos amis !');
            } else {
                mesAmisIds.push(ami.id);
                localStorage.setItem('mesAmis_' + utilisateur.id, JSON.stringify(mesAmisIds));
                alert('‚úÖ ' + ami.nom + ' a √©t√© ajout√© √† vos amis !');
            }
            
            afficherMesAmisTest();
        }
        
        // Fonction pour ajouter un ami rapidement
        function testerAjouterAmiRapide(email) {
            const ami = window.amisDatabase.find(a => a.email === email);
            
            if (!ami) return;
            
            const utilisateur = obtenirUtilisateurConnecte() || { id: 'USER_TEST' };
            let mesAmisIds = JSON.parse(localStorage.getItem('mesAmis_' + utilisateur.id) || '[]');
            
            if (mesAmisIds.includes(ami.id)) {
                alert('‚ÑπÔ∏è ' + ami.nom + ' est d√©j√† dans vos amis !');
            } else {
                mesAmisIds.push(ami.id);
                localStorage.setItem('mesAmis_' + utilisateur.id, JSON.stringify(mesAmisIds));
                alert('‚úÖ ' + ami.nom + ' ajout√© avec succ√®s !');
            }
            
            afficherMesAmisTest();
        }
        
        // Afficher mes amis
        function afficherMesAmisTest() {
            const container = document.getElementById('mesAmisDisplay');
            const utilisateur = obtenirUtilisateurConnecte() || { id: 'USER_TEST' };
            const mesAmisIds = JSON.parse(localStorage.getItem('mesAmis_' + utilisateur.id) || '[]');
            
            if (mesAmisIds.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">Aucun ami pour le moment</p>';
                return;
            }
            
            const mesAmis = window.amisDatabase.filter(ami => mesAmisIds.includes(ami.id));
            
            let html = '';
            mesAmis.forEach(ami => {
                html += `
                    <div class="friend-card" onclick="ouvrirProfilAmi('${ami.id}')">
                        <div class="friend-avatar">
                            <img src="${ami.avatar}" alt="${ami.nom}">
                            ${ami.enLigne ? '<div class="online-badge"></div>' : ''}
                        </div>
                        <div class="friend-name">${ami.nom}</div>
                        <div class="friend-email">${ami.email}</div>
                        <div class="friend-points">${ami.points} pts</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // Afficher tous les utilisateurs
        function afficherTousLesUtilisateurs() {
            const container = document.getElementById('tousLesUtilisateurs');
            
            let html = '';
            window.amisDatabase.forEach(ami => {
                html += `
                    <div class="friend-card" onclick="alert('üë§ ${ami.nom}\\n\\nüìß ${ami.email}\\nüì± ${ami.telephone}\\n‚≠ê ${ami.statut}\\nüèÜ ${ami.points} points')">
                        <div class="friend-avatar">
                            <img src="${ami.avatar}" alt="${ami.nom}">
                            ${ami.enLigne ? '<div class="online-badge"></div>' : ''}
                        </div>
                        <div class="friend-name">${ami.nom}</div>
                        <div class="friend-email">${ami.email}</div>
                        <div class="friend-points">${ami.statut}</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // R√©initialiser les amis
        function reinitialiserAmis() {
            if (!confirm('üîÑ R√©initialiser la liste d\'amis ?\n\nTous vos amis seront retir√©s.')) {
                return;
            }
            
            const utilisateur = obtenirUtilisateurConnecte() || { id: 'USER_TEST' };
            localStorage.setItem('mesAmis_' + utilisateur.id, '[]');
            
            alert('‚úÖ Liste d\'amis r√©initialis√©e !');
            afficherMesAmisTest();
        }
        
        // Initialisation
        window.addEventListener('load', function() {
            afficherMesAmisTest();
            afficherTousLesUtilisateurs();
        });
    </script>
</body>
</html>
